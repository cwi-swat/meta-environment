process P1 is 				%% toolbus.tool.Example
let R : int, Tid : example, Pid : term
in
    execute(example, Tid?) .
    create(P2(Tid), Pid?) .
    printf("tool id = %t\n", Tid) .
    snd-eval(Tid, msg("hello")) .
    rec-value(Tid, count(R?)) .
    printf("R = %d\n", R)
endlet

tool example is { host = "localhost" kind = "java" command ="toolbus.tool.Example"}

process P2(Tid : example) is
let Name : str
in
    rec-event(Tid, button(Name?)).
    printf("received %t\n", button(Name)) .
    snd-ack-event(Tid, button(Name))
endlet

process P3 is
let N : int
in
   N := 0 .
   ( if less(N, 50)
     then
	    printf("N = %d\n", N) . N := add(N, 1)
     else
        tau
     fi
  ) *
  if equal(N, 50) then shutdown("end-of-test") fi
endlet

toolbus(P1, P3)