module Pico-Integers

imports Layout Pico-Booleans
   
exports
  sorts PICO-NAT-CON PICO-NAT PICO-INT
  lexical syntax
    [0-9]+ -> PICO-NAT-CON
  context-free syntax
     PICO-NAT-CON                -> PICO-NAT
     PICO-NAT "-/" PICO-NAT      -> PICO-NAT {left}
     "(" PICO-NAT ")"            -> PICO-NAT {bracket}
     PICO-NAT                    -> PICO-INT
     "+" PICO-NAT                -> PICO-INT
     "-" PICO-NAT                -> PICO-INT
     PICO-INT "+" PICO-INT       -> PICO-INT {left}
     PICO-INT "-" PICO-INT       -> PICO-INT {left}
     PICO-INT "*" PICO-INT       -> PICO-INT {left}
     PICO-INT ">" PICO-INT       -> PICO-BOOL
     PICO-INT ">=" PICO-INT      -> PICO-BOOL
     PICO-INT "<" PICO-INT       -> PICO-BOOL
     PICO-INT "<=" PICO-INT      -> PICO-BOOL
     "(" PICO-INT ")"            -> PICO-INT {bracket}

  variables
    "Nat" [0-9\']*      -> PICO-NAT 
    "Nat-con" [0-9\']*  -> PICO-NAT-CON
    "Int" [0-9\']*      -> PICO-INT

  context-free priorities
    PICO-INT "*" PICO-INT -> PICO-INT >
    {left: PICO-INT "+" PICO-INT -> PICO-INT
           PICO-INT "-" PICO-INT -> PICO-INT}

hiddens
  context-free syntax
    "gt" "(" PICO-NAT "," PICO-NAT ")" -> PICO-BOOL
    PICO-NAT "-//" PICO-NAT          -> PICO-NAT
    PICO-NAT ">-" PICO-NAT           -> PICO-NAT

  variables 
    "n" [0-9]* -> PICO-NAT-CON
    "c" [0-9]* -> CHAR
    "x" [0-9]* -> CHAR*
    "y" [0-9]* -> CHAR+
