# Directory: compiler/support

# Configure variable substitutions
PRODUCT		= @PRODUCT@
VERSION		= @VERSION@

@SET_MAKE@

srcdir		= @srcdir@
VPATH		= @srcdir@
top_srcdir	= @top_srcdir@
prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@
libdir		= @libdir@
includedir	= $(prefix)/include
docdir		= $(top_srcdir)/docs

SHELL		= @SHELL@
MAKEDEPEND	= @MAKEDEPEND@
CC		= @CC@
CFLAGS		= @CFLAGS@ ${XCFLAGS}
CPP		= @CPP@
CPPFLAGS	= @CPP@ ${XCPPFLAGS}
DEFS		= @DEFS@ ${XDEFS}
INCLUDES	= @INCLUDES@ ${XINCLUDES}
LIBS		= @LIBS@ ${XLIBS}
SOCKLIBS	= @SOCKLIBS@

INSTALL		= @INSTALL@
INSTALL_DATA	= @INSTALL_DATA@
INSTALL_PROG	= @INSTALL_PROG@
UNINSTALL	= @UNINSTALL@

AR		= @AR@

ATERM		= @ATERM@
ATERMBIN	= @ATERMBIN@
ATERMLIB	= @ATERMLIB@
ATERMINC	= @ATERMINC@
TOOLBUS		= @TOOLBUS@
TOOLBUSBIN	= @TOOLBUSBIN@
TOOLBUSLIB	= @TOOLBUSLIB@
TOOLBUSINC	= @TOOLBUSINC@

# Implicit rules
include ${top_srcdir}/implicit-rules

# The eXtra parts of some variables
XCFLAGS		=
XCPPFLAGS	=
XINCLUDES	= -I$(ATERMINC)
XLIBS		= 

# Other variables
# CSRC/CHDR are used to calculate dependencies.
CSRC		= support.c rewriter.c rewriter.tif.c
CHDR		= rewriter.tif.h
# All files in BINFILES are installed in $(bindir)
BINFILES	= 
# All files in LIBFILES are installed in $(libdir)
LIBFILES	= libsupport-cc.a libsupport-gcc.a \
		libsupport-prof.a libsupport-dbg.a
# All files in INCLUDEFILES are installed in $(includedir)
INCLUDEFILES	= support.h libsupport.h
# All files in DOCFILES are copied to $(docdir)
DOCFILES	=

OBJ_CC          = $(patsubst %.c,%-cc.o,$(CSRC))
OBJ_GCC         = $(patsubst %.c,%-gcc.o,$(CSRC))
OBJ_DBG         = $(patsubst %.c,%-dbg.o,$(CSRC))
OBJ_PROF        = $(patsubst %.c,%-prof.o,$(CSRC))

# CLEANFILES are removed by 'make clean'
CLEANFILES	= rewriter.tif.c rewriter.tif.h \
		libsupport-cc.a libsupport-gcc.a \
		libsupport-prof.a libsupport-dbg.a
# DISTCLEANFILES are removed by 'make distclean'
DISTCLEANFILES	= 

.SILENT:	depend

# The all target must be defined:
all: depend $(BINFILES) $(LIBFILES) $(INCLUDEFILES)

# Explicit rules
# example: 'mytest.c: mytest.c.nw'

%.tif.c %.tif.h: %.tifs
	$(ATERMBIN)/tifstoc -tool $* $<

%.tifs: %.tb
	$(TOOLBUSBIN)/toolbus -gentifs $<

%-cc.o: %.c
	cc -O $(INCLUDES) -c -o $@ $<

%-gcc.o: %.c
	gcc -Wall -O4 $(INCLUDES) -c -o $@ $<

%-dbg.o: %.c
	gcc -Wall -g $(INCLUDES) -c -o $@ $<

%-prof.o: %.c
	gcc -Wall -pg $(INCLUDES) -c -o $@ $<

libsupport-cc.a: $(OBJ_CC)
	$(AR) cr $@ $(OBJ_CC)

libsupport-gcc.a: $(OBJ_GCC)
	$(AR) cr $@ $(OBJ_GCC)

libsupport-dbg.a: $(OBJ_DBG)
	$(AR) cr $@ $(OBJ_DBG)

libsupport-prof.a: $(OBJ_PROF)
	$(AR) cr $@ $(OBJ_PROF)

depend: ${CSRC}
	${MAKEDEPEND} $(INCLUDES) $(CSRC)	> .gendep
	cat .gendep | sed "s/.o:/-cc.o:/"	>  depend
	cat .gendep | sed "s/.o:/-gcc.o:/"	>> depend
	cat .gendep | sed "s/.o:/-dbg.o:/"	>> depend
	cat .gendep | sed "s/.o:/-prof.o:/"	>> depend
	rm -f .gendep

##########################################################
### Everything below this line should remain unchanged ###
##########################################################

# install target (install binaries, include files, and libraries)
install: all
	mkdir -p $(bindir) $(libdir) $(includedir)
	@$(INSTALL_PROG) $(INSTALL) $(bindir) $(BINFILES)
	@$(INSTALL_DATA) $(INSTALL) $(libdir) $(LIBFILES)
	@$(INSTALL_DATA) $(INSTALL) $(includedir) $(INCLUDEFILES)

# uninstall target (remove all files installed by 'install' target)
uninstall:
	@$(UNINSTALL) $(bindir) $(BINFILES)
	@$(UNINSTALL) $(libdir) $(LIBFILES)
	@$(UNINSTALL) $(includedir) $(INCLUDEFILES)

# doc target (copy generated documentation files to $(docdir))
doc: $(DOCFILES)
	@$(INSTALL_DATA) $(INSTALL) $(docdir) $(DOCFILES)

# clean target (remove all easily build components and temporary files)
clean:
	rm -f *.o *~ $(CLEANFILES)

# distclean target (also remove any files created by 'configure')
distclean: clean
	rm Makefile $(DISTCLEANFILES)

# distclean target

# Included dependencies
-include depend
