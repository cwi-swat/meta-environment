\MODULEBEGIN{Pico-typecheck-old}
\IMPORTS{\LEX{Type-environments}}
\EXPORTSBEGIN{}
\CFGBEGIN{}
\CFGFUN{\LEX{tc} \ULEX{PROGRAM}}{\ULEX{BOOL}}{}
 \CFGFUN{\QLEX{$[$} \ULEX{DECLS} \QLEX{$]$}}{\ULEX{TENV}}{}
 \CFGFUN{\ULEX{TENV} \ULEX{SERIES}}{\ULEX{BOOL}}{}
 \CFGFUN{\ULEX{TENV} \QLEX{$.$} \ULEX{EXP}}{\ULEX{TYPE}}{}
 \CFGFUN{\LEX{compatible}(\ULEX{TYPE}, \ULEX{TYPE})}{\ULEX{BOOL}}{}
\CFGEND{}
\EXPORTSEND{}
\EQUATIONSBEGIN{}
\CEQU{\LEX{$[$}\LEX{Tc1a}\LEX{$]$}}%
{\COND{\LEX{tc}~\penalty+5\LEX{begin}~\penalty+10\VAR{\LEX{D}}{}~\penalty+10\VAR{\LEX{S}}{}~\penalty+10\LEX{end}}{\CON{true}}}{{\COND{\LEX{$[$}\VAR{\LEX{D}}{}\LEX{$]$}~\penalty+5\VAR{\LEX{S}}{}}{\CON{true}}}}%
\CEQU{\LEX{$[$}\LEX{Tc1b}\LEX{$]$}}%
{\COND{\LEX{tc}~\penalty+5\LEX{begin}~\penalty+10\VAR{\LEX{D}}{}~\penalty+10\VAR{\LEX{S}}{}~\penalty+10\LEX{end}}{\CON{false}}}{{\NCOND{\LEX{$[$}\VAR{\LEX{D}}{}\LEX{$]$}~\penalty+5\VAR{\LEX{S}}{}}{\CON{true}}}}%
\CEQU{\LEX{$[$}\LEX{Tc2}\LEX{$]$}}%
{\COND{\LEX{$[$}\LEX{declare}~\penalty+10\VAR{\LEX{Id}}{}~\penalty+20\LEX{$:$}~\penalty+20\VAR{\LEX{Type}}{},\VAR{\LEX{Id-type-list}}{}\LEX{$;$}\LEX{$]$}}{\LEX{$[$}\VAR{\LEX{Id}}{}~\penalty+15\LEX{$:$}~\penalty+15\VAR{\LEX{Type}}{},\VAR{\LEX{Pair-list}}{}\LEX{$]$}}}{{\COND{\LEX{$[$}\LEX{declare}~\penalty+10\VAR{\LEX{Id-type-list}}{}\LEX{$;$}\LEX{$]$}}{\LEX{$[$}\VAR{\LEX{Pair-list}}{}\LEX{$]$}}}}%
\EQU{\LEX{$[$}\LEX{Tc3}\LEX{$]$}}{\LEX{$[$}\LEX{declare}~\penalty+10\LEX{$;$}\LEX{$]$}}{\LEX{$[$}\LEX{$]$}}
\\
\CEQU{\LEX{$[$}\LEX{Tc4}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\VAR{\LEX{Stat}}{};\VAR{\LEX{Stat-list}}{}}{\CON{true}}}{{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\VAR{\LEX{Stat}}{}}{\CON{true}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\VAR{\LEX{Stat-list}}{}}{\CON{true}}}}%
\EQU{\LEX{$[$}\LEX{Tc5}\LEX{$]$}}{\VAR{\LEX{Tenv}}{}~\penalty+5}{\CON{true}}
\\
\CEQU{\LEX{$[$}\LEX{Tc6}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\VAR{\LEX{Id}}{}~\penalty+15\LEX{$:=$}~\penalty+15\VAR{\LEX{Exp}}{}}{\CON{true}}}{{\COND{\LEX{compatible}\LEX{$($}\VAR{\LEX{Tenv}}{}~\penalty+10\LEX{$.$}~\penalty+10\VAR{\LEX{Id}}{}\LEX{$,$}~\penalty+5\VAR{\LEX{Tenv}}{}~\penalty+10\LEX{$.$}~\penalty+10\VAR{\LEX{Exp}}{}\LEX{$)$}}{\CON{true}}}}%
\CEQU{\LEX{$[$}\LEX{Tc7}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{if}~\penalty+15\VAR{\LEX{Exp}}{}~\penalty+15\LEX{then}~\penalty+15\IVAR{\LEX{S}}{1}{}~\penalty+15\LEX{else}~\penalty+15\IVAR{\LEX{S}}{2}{}~\penalty+15\LEX{fi}}{\CON{true}}}{{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\VAR{\LEX{Exp}}{}}{\CON{natural}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\IVAR{\LEX{S}}{1}{}}{\CON{true}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\IVAR{\LEX{S}}{2}{}}{\CON{true}}}}%
\CEQU{\LEX{$[$}\LEX{Tc8}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{while}~\penalty+15\VAR{\LEX{Exp}}{}~\penalty+15\LEX{do}~\penalty+15\VAR{\LEX{S}}{}~\penalty+15\LEX{od}}{\CON{true}}}{{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\VAR{\LEX{Exp}}{}}{\CON{natural}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\VAR{\LEX{S}}{}}{\CON{true}}}}%
\CEQU{\LEX{$[$}\LEX{Tc9}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{1}{}~\penalty+10\LEX{$+$}~\penalty+10\IVAR{\LEX{Exp}}{2}{}}{\CON{natural}}}{{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{1}{}}{\CON{natural}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{2}{}}{\CON{natural}}}}%
\CEQU{\LEX{$[$}\LEX{Tc10}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{1}{}~\penalty+10\LEX{$-$}~\penalty+10\IVAR{\LEX{Exp}}{2}{}}{\CON{natural}}}{{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{1}{}}{\CON{natural}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{2}{}}{\CON{natural}}}}%
\CEQU{\LEX{$[$}\LEX{Tc11}\LEX{$]$}}%
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{1}{}~\penalty+10\LEX{$||$}~\penalty+10\IVAR{\LEX{Exp}}{2}{}}{\CON{string}}}{{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{1}{}}{\CON{string}}}, 
{\COND{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\IVAR{\LEX{Exp}}{2}{}}{\CON{string}}}}%
\EQU{\LEX{$[$}\LEX{Tc12}\LEX{$]$}}{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\VAR{\LEX{Id}}{}}{\LEX{lookup}~\penalty+5\VAR{\LEX{Id}}{}~\penalty+5\LEX{in}~\penalty+5\VAR{\LEX{Tenv}}{}}
\EQU{\LEX{$[$}\LEX{Tc13}\LEX{$]$}}{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\VAR{\LEX{Nat-con}}{}}{\CON{natural}}
\EQU{\LEX{$[$}\LEX{Tc14}\LEX{$]$}}{\VAR{\LEX{Tenv}}{}~\penalty+5\LEX{$.$}~\penalty+5\VAR{\LEX{Str-con}}{}}{\CON{string}}
\\
\EQU{\LEX{$[$}\LEX{Tca}\LEX{$]$}}{\LEX{compatible}\LEX{$($}\CON{natural}\LEX{$,$}~\penalty+5\CON{natural}\LEX{$)$}}{\CON{true}}
\EQU{\LEX{$[$}\LEX{Tcb}\LEX{$]$}}{\LEX{compatible}\LEX{$($}\CON{string}\LEX{$,$}~\penalty+5\CON{string}\LEX{$)$}}{\CON{true}}
\EQUATIONSEND{}
\MODULEEND{}
