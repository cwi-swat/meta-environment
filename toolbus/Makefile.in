# @configure_input@
# ToolBus

PRODUCT		= @PRODUCT@
VERSION		= @VERSION@
SHELL		= /bin/sh
srcdir		= @srcdir@
VPATH		= @srcdir@

@SET_MAKE@
prefix 		= @prefix@
exec_prefix 	= @exec_prefix@
bindir		= @bindir@
libdir		= @libdir@
datadir		= @datadir@
bitmapdir	= $(datadir)/bitmaps
tidedir		= $(datadir)/tide
includedir	= @includedir@

CLEAN		= @CLEAN@

MODULES		= 
SUBDIRS		= @SUBDIRS@
XTRADIRS	= @XTRADIRS@
ALLDIRS		= src test tide adapters demos doc www
DISTFILES	= Makefile.in README INSTALL CONTRIBUTORS install-sh mkinstalldirs \
		  configure.in configure CHANGES.txt

all clean distclean install uninstall:
	@SUBDIRS="${SUBDIRS}";\
	case $@ in \
	  clean) ${CLEAN} ;;\
	  distclean) ${CLEAN};rm -f Makefile config.status config.log config.cache; rm -f lib/* include/* bin/* ;;\
	  install) SUBDIRS="src test ${XTRADIRS} adapters tbviz";$(srcdir)/mkinstalldirs $(bindir) $(libdir) $(tidedir) $(bitmapdir) $(includedir) ;;\
	  all) SUBDIRS="src test ${XTRADIRS} adapters";;\
	esac; \
	for SUBDIR in $$SUBDIRS; \
	do \
		echo Make $@ in $$SUBDIR; \
		cd $${SUBDIR}; \
		${MAKE} $@;  \
		cd .. ; \
	done

doc::
	@mkdir doc/adapters || true
	(cd adapters; ${MAKE} $@)
	(cd doc; ${MAKE})

demos::
	cd demos; \
	${MAKE};  \
	cd ..	

dist: $(DISTFILES)
	@rm -rf ../$(PRODUCT)-$(VERSION)
	@mkdir ../$(PRODUCT)-$(VERSION)
	@chmod 777 ../$(PRODUCT)-$(VERSION)
	@echo "Copying distribution files"
	@for file in $(DISTFILES); do \
	  ln $(srcdir)/$$file ../$(PRODUCT)-$(VERSION) 2> /dev/null \
	  || cp $(srcdir)/$$file ../$(PRODUCT)-$(VERSION); \
	done
	@for subdir in $(ALLDIRS); do \
	  echo Making $@ in $$subdir; \
	  mkdir ../$(PRODUCT)-$(VERSION)/$$subdir; \
	  chmod 777 ../$(PRODUCT)-$(VERSION)/$$subdir; \
	  (cd $$subdir && $(MAKE) $@) || exit 1; \
	done
	@ chmod -R +r  ../$(PRODUCT)-$(VERSION)
	@ cd ..;tar chof $(PRODUCT)-$(VERSION).tar $(PRODUCT)-$(VERSION)
	@ gzip ../$(PRODUCT)-$(VERSION).tar
	# rm -rf ../$(PRODUCT)-$(VERSION)

