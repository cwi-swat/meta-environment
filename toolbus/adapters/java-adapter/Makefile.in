# The following variables are instantiated using the configure script
# generated by autoconf:

PRODUCT		= @PRODUCT@
VERSION		= @VERSION@

srcdir		= @srcdir@
VPATH		= @srcdir@
top_srcdir      = @top_srcdir@

prefix          = @prefix@
exec_prefix     = @exec_prefix@
bindir		= @bindir@
libdir		= @libdir@
docdir		= $(top_srcdir)/doc
includedir      = $(prefix)/include
classdir	= $(prefix)/classes

SHELL		= /bin/sh

INSTALL		= @INSTALL@
CLEAN		= @CLEAN@
NOWEB		= @NOWEB@

ADAPTER-NAME	= java-adapter
DISTFILES	= Makefile.in $(PROGRAMS) $(DOC)

PROGRAMS        = java-adapter
DOC		= java-adapter.guide.tex
SUBDIRS		= toolbus/util toolbus/aterm toolbus/tool

all:
	@for dir in $(SUBDIRS); do \
		cd $$dir; $(MAKE) $@; cd ../..; \
	done

clean:
	@for dir in $(SUBDIRS); do \
		cd $$dir; $(MAKE) $@; cd ../..; \
	done

distclean:
	@for dir in $(SUBDIRS); do \
		cd $$dir; $(MAKE) $@; cd ../..; \
	done

dist: $(DISTFILES)
	@for file in $(DISTFILES); do \
	  ln $(srcdir)/$$file $(top_srcdir)/../$(PRODUCT)-$(VERSION)/adapters/$(ADAPTER-NAME) 2> /dev/null \
	  || cp $(srcdir)/$$file $(top_srcdir)/../$(PRODUCT)-$(VERSION)/adapters/$(ADAPTER-NAME); \
	done
	@mkdir $(top_srcdir)/../$(PRODUCT)-$(VERSION)/adapters/java-adapter/toolbus
	@for subdir in $(SUBDIRS); do \
		echo "Making $@ in $$subdir"; \
		dir=$(top_srcdir)/../$(PRODUCT)-$(VERSION)/adapters/java-adapter/$$subdir; \
		mkdir $$dir; \
		chmod 777 $$dir; \
		(cd $$subdir &&  $(MAKE) $@) || exit 1; \
	done

install: $(PROGRAMS)
	for file in $(PROGRAMS); do\
	  $(INSTALL) $$file $(bindir); \
	done
	@for dir in $(SUBDIRS); do \
		cd $$dir; $(MAKE) $@; cd ../..; \
	done

doc: $(DOC)
	for file in $(DOC); do \
	  $(INSTALL) $$file $(docdir)/adapters; \
	done
	$(top_srcdir)/mkinstalldirs $(docdir)/classes
	javadoc -author -version -d $(docdir)/classes \
		-sourcepath $$CLASSPATH:toolbus/aterm:toolbus/tool:toolbus/util:toolbus/tide \
		toolbus.aterm toolbus.util toolbus.tool

uninstall:
	for file in $(PROGRAMS); do\
	  rm -f $(bindir)/$$file; \
	done
	for dir in $(SUBDIRS); do \
		cd $$dir; $(MAKE) $@; cd ../..; \
	done
