# Template Makefile.in for demos

PRODUCT		= @PRODUCT@
VERSION		= @VERSION@

srcdir		= @srcdir@
top_srcdir	= @top_srcdir@
prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir 		= $(exec_prefix)/bin
libdir		= $(exec_prefix)/lib
includedir	= $(prefix)/include

CC		= @CC@
SHELL		= /bin/sh
CFLAGS		= @CFLAGS@
INCLUDES	= @INCLUDES@ -I$(includedir)
LIBS		= @LIBS@ 
TBLIB		= $(libdir)/libtb.a

CLEAN		= @CLEAN@

NOWEB		= @NOWEB@

DISTDIR		= $(top_srcdir)/../$(PRODUCT)-$(VERSION)/demos/$(DIR)

DIR		= hearts
DISTFILES	= $(SRC) $(GENSRC) $(SCRIPTS) $(DOC) Makefile.in bitmaps

COMPILE = $(CC) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS) $@.c -o $@ $(TBLIB) $(LIBS)

.SUFFIXES:
.SUFFIXES: .c .o

SRC		= hearts.tb.nw umpire.c.nw braindead.pl.nw randi.c.nw \
		heart-breaker.tcl.nw common.h.nw
GENSRC		= hearts.tb umpire.c braindead.pl randi.c heart-breaker.tcl \
		common.h
SCRIPTS		= heart-breaker heart-land
PROGRAMS	= umpire braindead randi
DOC		= braindead.pl.tex randi.c.tex

all:    ${PROGRAMS} ${DOC} ${SRC} ${GENSRC}

umpire: umpire.c umpire.tif.c common.h
	$(COMPILE)

randi: randi.c player.tif.c common.h
	$(COMPILE)

braindead: braindead.pl
	tbswipl -o braindead -c braindead.pl

umpire.c umpire.c.tex: umpire.c.nw
	$(NOWEB) umpire.c.nw
	touch umpire.c umpire.c.tex

randi.c randi.c.tex: randi.c.nw
	$(NOWEB) randi.c.nw
	touch randi.c randi.c.tex

common.h common.h.tex: common.h.nw
	$(NOWEB) common.h.nw
	touch common.h common.h.tex

braindead.pl braindead.pl.tex: braindead.pl.nw
	$(NOWEB) braindead.pl.nw
	touch braindead.pl braindead.pl.tex

heart-breaker.tcl heart-breaker.tcl.tex: heart-breaker.tcl.nw
	$(NOWEB) heart-breaker.tcl.nw
	touch heart-breaker.tcl heart-breaker.tcl.tex

hearts.tb hearts.tb.tex: hearts.tb.nw
	$(NOWEB) hearts.tb.nw
	touch hearts.tb hearts.tb.tex

umpire.tif.c: hearts.tifs
	ctif -newstyle -tool umpire -tifs hearts.tifs

player.tif.c: hearts.tifs
	ctif -tool player -tifs hearts.tifs

hearts.tifs: hearts.tb
	toolbus -gentifs hearts.tb

clean:
	${CLEAN} ${PROGRAMS} umpire.tif.c player.tif.c

distclean: clean
	rm -f Makefile

dist: $(DISTFILES)
	@for file in $(DISTFILES); do \
	  ln $(srcdir)/$$file $(DISTDIR) 2>/dev/null \
	  || cp -r $(srcdir)/$$file $(DISTDIR); \
	done
	

