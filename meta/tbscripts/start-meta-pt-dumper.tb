#include "meta.tb"
#include "status.tb"

process StandalonePtDumper is
let
  ModuleName: str,
  ErrorMessage: str,
  Pid: int
in
  create(StatusDisplay, Pid?)
  . create(MetaCreator, Pid?)
  . rec-msg(creation-finished)
  . InitializeTermStore(TERMSTORENAME)
  . OpenModules([MODULENAME], sdf)
  . snd-msg(dump-parse-table-given-file(MODULENAME, OUTFILENAME, trm))
  . rec-msg(parse-table-dumped)
  .
  if equal(SAVING, "true") then
    snd-msg(save-termstore)
    .
    (
      rec-msg(saved)
    +
      rec-msg(not-saved(ErrorMessage?))
    )
  else
    tau
  fi
  . shutdown("")
endlet

toolbus(StandalonePtDumper)
