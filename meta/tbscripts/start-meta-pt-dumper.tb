#include "meta.tb"
#include "status.tb"

process StandalonePtDumper is
let
  ErrorMessage: str,
  ModuleId: term,
  Pid: int
in
  create(StatusDisplay, Pid?)
  . create(MetaCreator, Pid?)
  . rec-msg(creation-finished)
  . InitializeTermStore(TERMSTORENAME)
  . OpenModule(MODULENAME, ModuleId?)
  . DumpParseTable(ModuleId, OUTFILENAME, trm)
  .
  if equal(SAVING, "true") then
    snd-msg(save-termstore)
    .
    (
      rec-msg(saved)
    +
      rec-msg(not-saved(ErrorMessage?))
    )
  else
    tau
  fi
  . shutdown("")
endlet

toolbus(StandalonePtDumper)
