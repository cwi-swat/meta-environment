# @configure_input@
# Directory: new-meta

# Configure variable substitutions
PRODUCT		= @PRODUCT@
VERSION		= @VERSION@

@SET_MAKE@

srcdir		= @srcdir@
VPATH		= @srcdir@
top_srcdir	= @top_srcdir@
prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@
libdir		= @libdir@
includedir	= @includedir@
datadir		= @datadir@
classdir        = ${prefix}/classes/nl/cwi/gipe/stred

SHELL		= @SHELL@

INSTALL		= @INSTALL@
INSTALL_DATA	= @INSTALL_DATA@
INSTALL_PROG	= @INSTALL_PROG@
UNINSTALL	= @UNINSTALL@

# Ordering is important here: the toolbus dir. should come first
SUBDIRS		= toolbus editor evaluator graph-browser \
		  in-output module-db asc-support compiler stred asource \
		  sglr pgen utils

# .SILENT:

all doc clean:	configure
	@for DIR in $(SUBDIRS);	\
	do \
		echo Make $@ in $$DIR; \
		cd $$DIR; \
		$(MAKE) -${MAKEFLAGS} $@; \
		cd ..; \
	done

configure:	configure.in
	@echo "Warning: configure script is out of date."
	@echo "Please (re)run autoconf and configure."

uninstall:
	$(UNINSTALL) $(bindir) meta
	@for DIR in $(SUBDIRS);	\
	do \
		echo Make $@ in $$DIR; \
		cd $$DIR; \
		$(MAKE) $@; \
		cd ..; \
	done

licensed:
	@clear; echo "Please read the following license carefully."; \
		sleep 2; sed -e 's/^/    /' LICENSE |more; echo ""; \
		echo "Do you accept this license? [no] "; read accept; \
		case "$$accept" in	\
			[yY]*)	echo License accepted by `whoami`@`hostname` on `date` > $@ ;; \
			*)	false ;; \
		esac

install:	licensed
	mkdir -p $(bindir) $(libdir) $(includedir) $(datadir) $(classdir)
	$(INSTALL_PROG) $(INSTALL) $(bindir) meta
	@for DIR in $(SUBDIRS);	\
	do \
		echo Make $@ in $$DIR; \
		cd $$DIR; \
		$(MAKE) $@; \
		cd ..; \
	done

distclean:
	rm -f Makefile Makefile.skel config.cache config.log config.status
	rm -f meta
	@for DIR in $(SUBDIRS);	\
	do \
		echo Make $@ in $$DIR; \
		cd $$DIR; \
		$(MAKE) $@; \
		cd ..; \
	done

# ObTribute to Larry Wall
love:
	@echo "not war"

depend:
