#!/bin/sh
# $Id$

prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=${exec_prefix}/bin
libdir=${exec_prefix}/lib

PATH="$PATH:$bindir"

PARSER="parse-sdf2 -1 -v"
GENERATOR="gen-table"

VERBOSE=1;

Notify () {
        if [ $VERBOSE -gt 0 ]
        then
                echo $*                                   >&2
        fi
}


while [ $# -gt 0 ]	# Handle command line options
do
	case $1
	in
		-v*)
			VERBOSE=0
			OPTS="$OPTS $1" ;;
		-*)
			echo Unknown option ignored: $1 ;;
		*)
			Files="$Files $1" ;;
	esac
	shift
done

for f in $Files
do
	base=`dirname $f`/`basename $f .sdf2`
	af2name=$base.asfix1
	tblname=$base.tbl
	Notify "Parsing $f..."
	if $PARSER $OPTS $f -o $af2name
	then
	        Notify "Generating parse table ..."
	        $GENERATOR $OPTS $af2name
	else
		echo "Error parsing $f"		>&2
	fi
done

